table R12Label
	lineageTag: 76bef692-4c9f-4a6e-9c06-bca08582acd1

	column Rolling12M_Label
		lineageTag: 6751f751-9ea1-4df9-b501-193c5e7515e9
		summarizeBy: none
		isNameInferred
		sourceColumn: [Rolling12M_Label]

		annotation SummarizationSetBy = Automatic

	partition R12Label = calculated
		mode: import
		source =
				
				VAR MinM =
				    MINX ( ALL ( 'dim_month'[MonthEnd] ), 'dim_month'[MonthEnd] )
				VAR MaxM =
				    MAXX ( ALL ( 'dim_month'[MonthEnd] ), 'dim_month'[MonthEnd] )
				VAR MonthsBetween =
				    DATEDIFF ( MinM, MaxM, MONTH )
				-- 能切出幾個 12 個月視窗（Current、Current-1、...）
				VAR Windows =
				    INT ( MonthsBetween / 12 ) + 1           -- 至少 1 組（Current）
				RETURN
				SELECTCOLUMNS (
				    GENERATESERIES ( 0, Windows - 1, 1 ),    -- 0,1,2,... → 代表往前 N 年
				    "Rolling12M_Label",
				        IF ( [Value] = 0, "Current", "Current-" & [Value] )
				)

	annotation PBI_Id = 2f646aa3dc4b4bbfbc1c747a56865393

